import os
import math
import pandas as pd
import numpy as np
import torch
import torch.nn as nn
import torch.nn.functional as F
from torch.utils.data import Dataset
from torch.utils.data import DataLoader


class sampleDataset(Dataset):
    def __init__(self, csv_file, array_dir, transform=None):
        self.annotations = pd.read_csv(csv_file)
        self.array_dir = array_dir
        self.transform = transform
    
    def __len__(self):
        return len(self.annotations)
    
    def __getitem__(self, index):
        array_path = os.path.join(self.array_dir, self.annotations.iloc[index, 0]+".npy")
        array = np.load(array_path)
        y_label = annotations.iloc[index,1]

        if self.transform:
            array = self.transform(array)
        
        return array, y_label